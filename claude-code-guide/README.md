# Claude Code 架构设计深度研究指南

> 完整的 Claude Code 技术架构文档，涵盖上下文工程、Subagent 系统、异步代理等核心概念

## 📚 文档导航

### 核心架构
- [**01. 整体架构设计**](./01-architecture.md)
  - 代理-子代理分层架构
  - 主要组件交互
  - 工具系统设计
  - 权限管理策略

### 上下文管理
- [**02. 上下文工程**](./02-context-engineering.md)
  - 三层记忆架构
  - 92% 智能压缩阈值
  - Token 预算管理
  - 无限对话支持

### 多代理系统
- [**03. Subagent 系统**](./03-subagent-system.md)
  - Explore / General / Bash 子代理
  - 工具访问权限
  - 生命周期管理
  - 协作机制

- [**04. 异步 Agent**](./04-async-agents.md)
  - 后台运行机制
  - TaskOutput 获取
  - 并行执行模式
  - 任务协调

### 高级特性
- [**05. 高级特性**](./05-advanced-features.md)
  - 代理恢复（Resume）
  - 任务管理系统（DAG）
  - Plan Mode 工作流
  - Skills 系统

- [**06. Hook 系统**](./06-hook-system.md)
  - Hook 类型和触发时机
  - 配置优先级
  - 实际应用场景
  - 工作流自动化

- [**07. MCP 集成**](./07-mcp-integration.md)
  - MCP 架构角色
  - 配置优先级
  - Tool Search 优化
  - 工具发现机制

### 配置和扩展
- [**10. Rules 系统**](./10-rules-system.md)
  - CLAUDE.md 配置
  - 模块化规则目录
  - 路径定向规则
  - 权限规则详解

- [**11. Plugins 系统**](./11-plugins-system.md)
  - 插件架构和组件
  - 安装和管理插件
  - 官方插件列表
  - 自定义插件开发

### 多会话协作
- [**12. Agent Teams 官方指南**](./12-agent-teams.md)
  - 多会话编排架构
  - TeammateTool 工具详解
  - 任务系统与消息通信
  - Subagent vs Agent Teams 对比
  - 编排模式与最佳实践

### 上下文工程与记忆系统
- [**13. 上下文工程基础概念**](./13-context-engineering-fundamentals.md)
  - 上下文工程的本质与重要性
  - 四大上下文问题（中毒/干扰/混淆/冲突）
  - WSCI 框架（Write/Select/Compress/Isolate）
  - 核心原则与实际案例
  - 工具与框架（LangGraph/LangSmith）

### 实践指南
- [**08. 最佳实践**](./08-best-practices.md)
  - 架构设计原则
  - 性能优化策略
  - 可靠性和调试
  - 企业级部署

- [**09. 参考资源**](./09-references.md)
  - 官方文档链接
  - 社区资源
  - 技术博客
  - 深度文章

## 🎯 核心概念速览

### 三层记忆架构
```
┌─────────────────────────────────────────┐
│     Layer 1: Working Memory (短期)      │
│  当前对话，高速低延迟，像CPU L1缓存      │
└─────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────┐
│   Layer 2: Active Context (中期)        │
│  最近的操作结果，语义压缩                │
└─────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────┐
│  Layer 3: Persistent State (长期)       │
│  任务列表、会话历史、文件系统            │
└─────────────────────────────────────────┘
```

### 子代理类型

| 子代理 | 角色 | 工具权限 | 使用场景 |
|--------|------|----------|----------|
| **Explore** | 只读探索者 | 读取、搜索 | 代码库分析、理解现有实现 |
| **General** | 完整功能代理 | 读写执行全部 | 复杂多步骤任务、并行工作 |
| **Bash** | 命令行专家 | Bash 命令 | 命令密集型操作、构建部署 |

### 关键数字

- **200k** - Claude Opus 4.5 最大上下文窗口
- **92%** - 触发智能压缩的阈值
- **7** - 最大并发子代理数量
- **4** - 主要运行模式（yolo, accepting edits, plan, default）
- **3** - 记忆层级数量

## 🚀 快速开始

### 1. 理解整体架构
从 [整体架构设计](./01-architecture.md) 开始，了解 Claude Code 的核心设计理念和组件交互。

### 2. 深入上下文工程
阅读 [上下文工程](./02-context-engineering.md)，理解如何实现无限对话和智能压缩。

### 3. 掌握多代理协作
学习 [Subagent 系统](./03-subagent-system.md) 和 [异步 Agent](./04-async-agents.md)，掌握并行处理能力。

### 4. 应用最佳实践
参考 [最佳实践](./08-best-practices.md)，优化你的工作流和性能。

## 💡 文档特色

- ✅ **全面覆盖** - 从基础到高级的完整知识体系
- ✅ **图表丰富** - 架构图、流程图、对比表
- ✅ **代码示例** - 实际配置和使用示例
- ✅ **最佳实践** - 基于官方文档和社区经验
- ✅ **中文详解** - 完整的中文技术说明

## 📖 阅读建议

### 初学者路径
1. README（本文档）→ 01 架构设计 → 02 上下文工程 → 03 Subagent → 08 最佳实践

### 开发者路径
1. 01 架构设计 → 03 Subagent → 04 异步 Agent → 12 Agent Teams → 05 高级特性

### 架构师路径
1. 01 架构设计 → 02 上下文工程 → 12 Agent Teams → 07 MCP 集成 → 08 最佳实践

### 企业用户路径
1. 01 架构设计 → 06 Hook 系统 → 12 Agent Teams → 08 最佳实践 → 07 MCP 集成

### 多代理系统专项路径（推荐）
1. 03 Subagent 系统 → 04 异步 Agent → 12 Agent Teams → 理解三种代理模式的差异

## 🔄 版本信息

- **文档版本**: v2.3.0
- **文档数量**: 13 个核心文档
- **总篇幅**: 约 420 KB
- **基于 Claude Code**: 2026 年最新版本
- **创建日期**: 2026-02-08
- **最后更新**: 2026-02-10
- **最新更新**: 新增上下文工程基础概念完整指南

## 📝 贡献与反馈

如有疑问或建议，欢迎：
- 在项目中创建 Issue
- 参考 [参考资源](./09-references.md) 中的官方文档
- 访问 Claude Code 官方仓库: https://github.com/anthropics/claude-code

---

**开始探索 Claude Code 的强大架构吧！** 🚀
