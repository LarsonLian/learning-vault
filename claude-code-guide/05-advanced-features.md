# 05. é«˜çº§ç‰¹æ€§

## ç›®å½•
- [5.1 ä»£ç†æ¢å¤ï¼ˆResumeï¼‰æœºåˆ¶](#51-ä»£ç†æ¢å¤resumeæœºåˆ¶)
- [5.2 ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼ˆDAGï¼‰](#52-ä»»åŠ¡ç®¡ç†ç³»ç»Ÿdag)
- [5.3 Plan Mode å·¥ä½œæµç¨‹](#53-plan-mode-å·¥ä½œæµç¨‹)
- [5.4 Skills ç³»ç»Ÿ](#54-skills-ç³»ç»Ÿ)

---

## 5.1 ä»£ç†æ¢å¤ï¼ˆResumeï¼‰æœºåˆ¶

### Session Resume æ¦‚è§ˆ

```
ä¼šè¯æ¢å¤çš„ä¸‰å¤§èƒ½åŠ›:

1. å®Œæ•´ä¸Šä¸‹æ–‡æ¢å¤
   â”œâ”€ å¯¹è¯å†å²
   â”œâ”€ æ–‡ä»¶çŠ¶æ€
   â”œâ”€ Git çŠ¶æ€
   â”œâ”€ ä»»åŠ¡è¿›åº¦
   â””â”€ å†³ç­–ä¸Šä¸‹æ–‡

2. è·¨è®¾å¤‡åŒæ­¥
   â”œâ”€ æœ¬åœ° CLI
   â”œâ”€ VS Code
   â”œâ”€ Web (claude.ai)
   â””â”€ Mobile App

3. æŒä¹…åŒ–ä¼šè¯
   â”œâ”€ æ•°å¤©/æ•°å‘¨çš„é•¿æœŸå¼€å‘
   â”œâ”€ å›¢é˜Ÿåä½œ
   â””â”€ é¡¹ç›®äº¤æ¥
```

### ä¼šè¯å­˜å‚¨ç»“æ„

```
ä¼šè¯æŒä¹…åŒ–å­˜å‚¨:

~/.claude/sessions/
â”œâ”€ sess_abc123/                    # ä¼šè¯ ID
â”‚  â”œâ”€ metadata.json                # ä¼šè¯å…ƒæ•°æ®
â”‚  â”‚  {
â”‚  â”‚    "session_id": "sess_abc123",
â”‚  â”‚    "created_at": "2026-02-01T09:00:00Z",
â”‚  â”‚    "last_active": "2026-02-08T15:30:00Z",
â”‚  â”‚    "title": "å®ç°ç”¨æˆ·ä»ªè¡¨æ¿",
â”‚  â”‚    "project_path": "/Users/user/project",
â”‚  â”‚    "git_branch": "feature/dashboard",
â”‚  â”‚    "total_turns": 342
â”‚  â”‚  }
â”‚  â”‚
â”‚  â”œâ”€ context.json                 # å‹ç¼©çš„ä¸Šä¸‹æ–‡
â”‚  â”‚  {
â”‚  â”‚    "summary": "é¡¹ç›®æ¦‚è¿°å’Œå…³é”®å†³ç­–...",
â”‚  â”‚    "decisions": [
â”‚  â”‚      {
â”‚  â”‚        "what": "ä½¿ç”¨ React Query ç®¡ç†çŠ¶æ€",
â”‚  â”‚        "why": "æ›´å¥½çš„ç¼“å­˜å’ŒåŒæ­¥",
â”‚  â”‚        "when": "2026-02-02"
â”‚  â”‚      }
â”‚  â”‚    ],
â”‚  â”‚    "architecture": {
â”‚  â”‚      "frontend": "React + TypeScript",
â”‚  â”‚      "backend": "Node.js + Express",
â”‚  â”‚      "database": "PostgreSQL"
â”‚  â”‚    }
â”‚  â”‚  }
â”‚  â”‚
â”‚  â”œâ”€ conversation/                # å®Œæ•´å¯¹è¯å†å²
â”‚  â”‚  â”œâ”€ turn_001.json
â”‚  â”‚  â”œâ”€ turn_002.json
â”‚  â”‚  â””â”€ ...
â”‚  â”‚
â”‚  â”œâ”€ tasks/                       # ä»»åŠ¡çŠ¶æ€å¿«ç…§
â”‚  â”‚  â””â”€ tasks_snapshot.json
â”‚  â”‚
â”‚  â””â”€ files/                       # æ–‡ä»¶çŠ¶æ€ç¼“å­˜
â”‚     â””â”€ file_states.json
â”‚
â”œâ”€ sess_def456/                    # å¦ä¸€ä¸ªä¼šè¯
â”‚  â””â”€ ...
â”‚
â””â”€ index.json                      # ä¼šè¯ç´¢å¼•
   {
     "sessions": [
       {
         "id": "sess_abc123",
         "title": "å®ç°ç”¨æˆ·ä»ªè¡¨æ¿",
         "last_active": "2026-02-08T15:30:00Z",
         "status": "active"
       },
       {
         "id": "sess_def456",
         "title": "ä¿®å¤è®¤è¯bug",
         "last_active": "2026-02-07T18:00:00Z",
         "status": "completed"
       }
     ]
   }
```

### ä½¿ç”¨ Resume

```bash
# åœºæ™¯ 1: åŸºæœ¬æ¢å¤
# Day 1
$ claude
> å¼€å§‹å®ç°ç”¨æˆ·ä»ªè¡¨æ¿
> ... (å·¥ä½œæ•°å°æ—¶)
> /exit

Claude: "ä¼šè¯å·²ä¿å­˜
         Session ID: sess_abc123
         æ¢å¤å‘½ä»¤: claude --resume sess_abc123"

# Day 2
$ claude --resume sess_abc123

Claude: "æ¢å¤ä¼šè¯: å®ç°ç”¨æˆ·ä»ªè¡¨æ¿
         ä¸Šæ¬¡æ´»åŠ¨: æ˜¨å¤© 15:30

         ä¸Šä¸‹æ–‡æ‘˜è¦:
         - å·²å®Œæˆ: æ•°æ®è·å–é€»è¾‘
         - è¿›è¡Œä¸­: ä»ªè¡¨æ¿ UI ç»„ä»¶
         - å¾…åŠ: å›¾è¡¨é›†æˆ

         è®©æˆ‘ä»¬ç»§ç»­..."

> ç»§ç»­å®ç°å›¾è¡¨ç»„ä»¶
[Claude å®Œå…¨ç†è§£ä¹‹å‰çš„ä¸Šä¸‹æ–‡]

---

# åœºæ™¯ 2: è‡ªåŠ¨æ¢å¤æœ€è¿‘ä¼šè¯
$ claude --resume

Claude: "æ‰¾åˆ°æœ€è¿‘çš„ä¼šè¯:

         1. å®ç°ç”¨æˆ·ä»ªè¡¨æ¿ (2å°æ—¶å‰)
         2. ä¿®å¤è®¤è¯bug (æ˜¨å¤©)
         3. æ·»åŠ APIç«¯ç‚¹ (3å¤©å‰)

         æ¢å¤å“ªä¸ª? [1/2/3]"

$ 1

Claude: "æ¢å¤ä¼šè¯ 1..."

---

# åœºæ™¯ 3: åˆ—å‡ºæ‰€æœ‰ä¼šè¯
$ claude --list-sessions

Output:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Available Sessions                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Active (2):                                            â”‚
â”‚ [1] å®ç°ç”¨æˆ·ä»ªè¡¨æ¿                                     â”‚
â”‚     Last active: 2 hours ago                           â”‚
â”‚     Session ID: sess_abc123                            â”‚
â”‚     342 turns, 5 tasks pending                         â”‚
â”‚                                                        â”‚
â”‚ [2] æ€§èƒ½ä¼˜åŒ–                                           â”‚
â”‚     Last active: Yesterday                             â”‚
â”‚     Session ID: sess_xyz789                            â”‚
â”‚     128 turns, 2 tasks completed                       â”‚
â”‚                                                        â”‚
â”‚ Completed (5):                                         â”‚
â”‚ [3] ä¿®å¤è®¤è¯bug (sess_def456)                         â”‚
â”‚ [4] æ·»åŠ APIç«¯ç‚¹ (sess_ghi789)                         â”‚
â”‚ [5] é‡æ„æ•°æ®å±‚ (sess_jkl012)                          â”‚
â”‚ ...                                                    â”‚
â”‚                                                        â”‚
â”‚ Archived (12):                                         â”‚
â”‚ [æŸ¥çœ‹å…¨éƒ¨]                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

---

# åœºæ™¯ 4: ä¼šè¯åˆ†æ”¯
$ claude --resume sess_abc123 --branch "å®éªŒæ€§é‡æ„"

Claude: "åˆ›å»ºä¼šè¯åˆ†æ”¯:
         åŸä¼šè¯: sess_abc123
         æ–°ä¼šè¯: sess_abc123_branch_001

         ä¸Šä¸‹æ–‡å·²å¤åˆ¶
         ä½ å¯ä»¥åœ¨ä¸å½±å“åŸä¼šè¯çš„æƒ…å†µä¸‹å®éªŒ"

> å°è¯•ä½¿ç”¨ Zustand æ›¿ä»£ React Query
[å®éªŒæ€§ä¿®æ”¹...]

> /abandon  # æ”¾å¼ƒåˆ†æ”¯
æˆ–
> /merge    # åˆå¹¶å›åŸä¼šè¯
```

### Teleport - è·¨å¹³å°ä¼šè¯è¿ç§»

```bash
# åœºæ™¯: åœ¨ä¸åŒå¹³å°é—´æ— ç¼åˆ‡æ¢

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Monday - åŠå…¬å®¤ (VS Code Extension)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VS Code ä¸­ä½¿ç”¨ Claude Code:                            â”‚
â”‚ > å¼€å§‹å®ç°æ–°åŠŸèƒ½                                       â”‚
â”‚ > ... (å·¥ä½œ 3 å°æ—¶)                                    â”‚
â”‚ > Claude Code: "ä¼šè¯å·²ä¿å­˜                             â”‚
â”‚                 Session ID: sess_office_001"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ Teleport
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Monday Evening - å®¶ä¸­ (Terminal CLI)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ $ claude --teleport sess_office_001                    â”‚
â”‚                                                        â”‚
â”‚ Claude: "ä» VS Code ä¼šè¯è¿ç§»...                        â”‚
â”‚          å®Œæ•´ä¸Šä¸‹æ–‡å·²æ¢å¤                              â”‚
â”‚          ä½ å¯ä»¥åœ¨ç»ˆç«¯ç»§ç»­å·¥ä½œ"                         â”‚
â”‚                                                        â”‚
â”‚ > ç»§ç»­å¼€å‘...                                          â”‚
â”‚ > ... (å·¥ä½œ 2 å°æ—¶)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ Teleport
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tuesday - å’–å•¡åº— (claude.ai Web)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åœ¨æµè§ˆå™¨æ‰“å¼€ claude.ai                                 â”‚
â”‚ > Teleport sess_office_001                             â”‚
â”‚                                                        â”‚
â”‚ Claude: "ä¼šè¯å·²åŒæ­¥                                    â”‚
â”‚          æ‰€æœ‰æ›´æ”¹å·²åˆå¹¶                                â”‚
â”‚          å¯ä»¥åœ¨ Web ç•Œé¢ç»§ç»­"                          â”‚
â”‚                                                        â”‚
â”‚ > å®¡æŸ¥ä»£ç å¹¶åšè®¾è®¡å†³ç­–                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ Teleport
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tuesday Afternoon - åŠå…¬å®¤ (VS Code)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å›åˆ° VS Code                                           â”‚
â”‚ > Claude Code è‡ªåŠ¨æ£€æµ‹åˆ°ä¼šè¯æ›´æ–°                       â”‚
â”‚ > "æ£€æµ‹åˆ°è¿œç¨‹æ›´æ”¹ï¼Œæ˜¯å¦åŒæ­¥? [Y/n]"                    â”‚
â”‚                                                        â”‚
â”‚ > Y                                                    â”‚
â”‚ > æ‰€æœ‰å¹³å°çš„å·¥ä½œå®Œå…¨åŒæ­¥                               â”‚
â”‚ > å®ŒæˆåŠŸèƒ½å¹¶éƒ¨ç½² âœ“                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Teleport ç‰¹æ€§:

âœ… å®æ—¶åŒæ­¥
   - è·¨è®¾å¤‡çš„å³æ—¶æ›´æ–°
   - å†²çªè‡ªåŠ¨è§£å†³

âœ… å®Œæ•´ä¸Šä¸‹æ–‡
   - å¯¹è¯å†å²
   - æ–‡ä»¶çŠ¶æ€
   - ä»»åŠ¡è¿›åº¦

âœ… å¹³å°æ— å…³
   - CLI â†” VS Code â†” Web â†” Mobile
   - æ— ç¼åˆ‡æ¢

âœ… å›¢é˜Ÿåä½œ
   - å…±äº«ä¼šè¯
   - ååŒç¼–ç¨‹
```

---

## 5.2 ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼ˆDAGï¼‰

### DAG ä»»åŠ¡ç³»ç»Ÿè¯¦è§£

```
ä»»åŠ¡ç³»ç»Ÿçš„æ ¸å¿ƒèƒ½åŠ›:

1. æœ‰å‘æ— ç¯å›¾ (DAG)
   â”œâ”€ å¤æ‚çš„ä»»åŠ¡ä¾èµ–å…³ç³»
   â”œâ”€ è‡ªåŠ¨å¹¶è¡Œè°ƒåº¦
   â””â”€ æ­»é”æ£€æµ‹

2. æŒä¹…åŒ–
   â”œâ”€ è·¨ä¼šè¯ä¿å­˜
   â”œâ”€ å¤šè®¾å¤‡åŒæ­¥
   â””â”€ å›¢é˜Ÿå…±äº«

3. åè°ƒ
   â”œâ”€ å¤šä»£ç†åä½œ
   â”œâ”€ çŠ¶æ€åŒæ­¥
   â””â”€ è¿›åº¦è¿½è¸ª
```

### ä»»åŠ¡ API è¯¦è§£

```typescript
// å®Œæ•´çš„ä»»åŠ¡ API

// 1. åˆ›å»ºä»»åŠ¡
TaskCreate({
  subject: "å®ç°ç”¨æˆ·è®¤è¯",              // ç®€çŸ­æ ‡é¢˜
  description: `
    å®ç°å®Œæ•´çš„JWTè®¤è¯ç³»ç»Ÿ:
    - æ³¨å†Œç«¯ç‚¹
    - ç™»å½•ç«¯ç‚¹
    - Token éªŒè¯ä¸­é—´ä»¶
    - å¯†ç å“ˆå¸Œ (bcrypt)
  `,                                    // è¯¦ç»†æè¿°

  activeForm: "å®ç°ç”¨æˆ·è®¤è¯ä¸­...",       // è¿›è¡Œæ—¶å½¢å¼

  add_blocked_by: ["task-setup-db"],    // ä¾èµ–çš„ä»»åŠ¡
  add_blocks: [],                       // é˜»å¡çš„ä»»åŠ¡

  metadata: {
    priority: "high",                   // ä¼˜å…ˆçº§
    estimated_time: "2 hours",          // é¢„ä¼°æ—¶é—´
    assigned_to: "general-subagent",    // åˆ†é…çš„ä»£ç†
    tags: ["backend", "security"],      // æ ‡ç­¾
    related_files: [                    // ç›¸å…³æ–‡ä»¶
      "src/auth.ts",
      "src/middleware/verify.ts"
    ]
  }
})

// è¿”å›: task_id

// 2. æ›´æ–°ä»»åŠ¡
TaskUpdate({
  task_id: "task-123",
  status: "in_progress",                // æ›´æ–°çŠ¶æ€

  metadata: {
    actual_time: "1.5 hours",           // å®é™…æ—¶é—´
    completion: 75                      // å®Œæˆç™¾åˆ†æ¯”
  },

  add_blocked_by: ["task-api-tests"],   // åŠ¨æ€æ·»åŠ ä¾èµ–

  // éƒ¨åˆ†æ›´æ–°å…¶ä»–å­—æ®µ
  description: "æ›´æ–°åçš„æè¿°..."
})

// 3. è·å–ä»»åŠ¡
TaskGet({
  task_id: "task-123"
})

// è¿”å›:
{
  id: "task-123",
  subject: "å®ç°ç”¨æˆ·è®¤è¯",
  description: "...",
  status: "in_progress",
  created_at: "2026-02-08T10:00:00Z",
  updated_at: "2026-02-08T11:30:00Z",
  blocked_by: ["task-setup-db"],
  blocking: ["task-api-integration"],
  metadata: { ... },
  output: {
    summary: "è®¤è¯é€»è¾‘å·²å®ç°ï¼Œæµ‹è¯•ä¸­...",
    files_modified: ["src/auth.ts"],
    progress: 75
  }
}

// 4. åˆ—å‡ºä»»åŠ¡
TaskList({
  filter: {
    status: "pending",                  // ç­›é€‰çŠ¶æ€
    tags: ["backend"],                  // ç­›é€‰æ ‡ç­¾
    assigned_to: "general-subagent"     // ç­›é€‰ä»£ç†
  },
  sort: "priority",                     // æ’åº
  limit: 10                             // é™åˆ¶æ•°é‡
})

// è¿”å›ä»»åŠ¡åˆ—è¡¨
```

### å¤æ‚ DAG ç¤ºä¾‹

```
ç”µå•†å¹³å°å®Œæ•´å®ç°:

                        Task 1
                    è®¾è®¡æ•°æ®åº“Schema
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                 â†“                 â†“
     Task 2            Task 3           Task 4
   å®ç°ç”¨æˆ·ç³»ç»Ÿ      å®ç°å•†å“ç³»ç»Ÿ     å®ç°è®¢å•ç³»ç»Ÿ
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                       Task 5
                   å®ç°è´­ç‰©è½¦ç³»ç»Ÿ
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                 â†“                 â†“
     Task 6            Task 7           Task 8
   é›†æˆæ”¯ä»˜ç½‘å…³      å®ç°ä¼˜æƒ åˆ¸       æ·»åŠ åº“å­˜ç®¡ç†
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                       Task 9
                    å‰ç«¯UIå®ç°
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                 â†“                 â†“
    Task 10           Task 11          Task 12
  å•å…ƒæµ‹è¯•         é›†æˆæµ‹è¯•          E2Eæµ‹è¯•
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                      Task 13
                  æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
                          â”‚
                          â†“
                      Task 14
                  æ–‡æ¡£å’Œéƒ¨ç½²

ä»»åŠ¡é…ç½®æ–‡ä»¶:

// tasks.config.json
{
  "project": "ç”µå•†å¹³å°",
  "tasks": [
    {
      "id": "1",
      "subject": "è®¾è®¡æ•°æ®åº“Schema",
      "agent": "explore",
      "estimated": "2h",
      "depends_on": []
    },
    {
      "id": "2",
      "subject": "å®ç°ç”¨æˆ·ç³»ç»Ÿ",
      "agent": "general",
      "estimated": "4h",
      "depends_on": ["1"]
    },
    {
      "id": "3",
      "subject": "å®ç°å•†å“ç³»ç»Ÿ",
      "agent": "general",
      "estimated": "4h",
      "depends_on": ["1"]
    },
    {
      "id": "4",
      "subject": "å®ç°è®¢å•ç³»ç»Ÿ",
      "agent": "general",
      "estimated": "5h",
      "depends_on": ["1"]
    },
    {
      "id": "5",
      "subject": "å®ç°è´­ç‰©è½¦ç³»ç»Ÿ",
      "agent": "general",
      "estimated": "3h",
      "depends_on": ["2", "3", "4"]
    },
    {
      "id": "6",
      "subject": "é›†æˆæ”¯ä»˜ç½‘å…³",
      "agent": "general",
      "estimated": "6h",
      "depends_on": ["5"]
    },
    {
      "id": "7",
      "subject": "å®ç°ä¼˜æƒ åˆ¸",
      "agent": "general",
      "estimated": "3h",
      "depends_on": ["5"]
    },
    {
      "id": "8",
      "subject": "æ·»åŠ åº“å­˜ç®¡ç†",
      "agent": "general",
      "estimated": "4h",
      "depends_on": ["5"]
    },
    {
      "id": "9",
      "subject": "å‰ç«¯UIå®ç°",
      "agent": "general",
      "estimated": "8h",
      "depends_on": ["6", "7", "8"]
    },
    {
      "id": "10",
      "subject": "å•å…ƒæµ‹è¯•",
      "agent": "bash",
      "estimated": "4h",
      "depends_on": ["9"]
    },
    {
      "id": "11",
      "subject": "é›†æˆæµ‹è¯•",
      "agent": "bash",
      "estimated": "3h",
      "depends_on": ["9"]
    },
    {
      "id": "12",
      "subject": "E2Eæµ‹è¯•",
      "agent": "bash",
      "estimated": "5h",
      "depends_on": ["9"]
    },
    {
      "id": "13",
      "subject": "æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–",
      "agent": "general",
      "estimated": "6h",
      "depends_on": ["10", "11", "12"]
    },
    {
      "id": "14",
      "subject": "æ–‡æ¡£å’Œéƒ¨ç½²",
      "agent": "general",
      "estimated": "3h",
      "depends_on": ["13"]
    }
  ]
}

æ‰§è¡Œ:

User: "åŠ è½½å¹¶æ‰§è¡Œ tasks.config.json"

Claude: [è§£æé…ç½®ï¼Œåˆ›å»ºä»»åŠ¡å›¾]

  "åˆ›å»ºäº† 14 ä¸ªä»»åŠ¡
   æœ€å¤§å¹¶è¡Œåº¦: 3 ä¸ªä»»åŠ¡
   é¢„è®¡æ€»æ—¶é—´: 18 å°æ—¶
   (ä¸²è¡Œéœ€è¦: 60 å°æ—¶)

   æ‰§è¡Œè®¡åˆ’:
   - é˜¶æ®µ 1: Task 1 (2h)
   - é˜¶æ®µ 2: Tasks 2-4 å¹¶è¡Œ (5h)
   - é˜¶æ®µ 3: Task 5 (3h)
   - é˜¶æ®µ 4: Tasks 6-8 å¹¶è¡Œ (6h)
   - é˜¶æ®µ 5: Task 9 (8h)
   - é˜¶æ®µ 6: Tasks 10-12 å¹¶è¡Œ (5h)
   - é˜¶æ®µ 7: Task 13 (6h)
   - é˜¶æ®µ 8: Task 14 (3h)

   å¼€å§‹æ‰§è¡Œ? [Y/n]"

User: "Y"

Claude: [å¼€å§‹æ‰§è¡Œï¼Œä»»åŠ¡åœ¨åå°è¿è¡Œ]

  "âœ“ Task 1 å®Œæˆ (2h)
   â³ Tasks 2-4 è¿›è¡Œä¸­ (å¹¶è¡Œ)
      Task 2: 60% å®Œæˆ
      Task 3: 75% å®Œæˆ
      Task 4: 45% å®Œæˆ

   æ‰€æœ‰ä»»åŠ¡åœ¨åå°è¿è¡Œ
   ä½ å¯ä»¥ç»§ç»­å…¶ä»–å·¥ä½œæˆ–ç›‘æ§è¿›åº¦"
```

### è·¨ä¼šè¯ä»»åŠ¡åè°ƒ

```bash
# åœºæ™¯: å›¢é˜Ÿåä½œï¼Œå…±äº«ä»»åŠ¡åˆ—è¡¨

# å›¢é˜Ÿæˆå‘˜ A (ä¸Šåˆ 9:00)
$ export CLAUDE_CODE_TASK_LIST_ID=team-project-001
$ claude

> æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
Claude: "å…±äº«ä»»åŠ¡åˆ—è¡¨: team-project-001

         å¯ç”¨ä»»åŠ¡ (æœªåˆ†é…):
         [1] å®ç°ç”¨æˆ·API (ä¼˜å…ˆçº§: é«˜)
         [2] è®¾è®¡UIç»„ä»¶ (ä¼˜å…ˆçº§: ä¸­)
         [3] ç¼–å†™æ–‡æ¡£ (ä¼˜å…ˆçº§: ä½)

         è®¤é¢†å“ªä¸ªä»»åŠ¡? [1/2/3]"

> 1

Claude: "âœ“ å·²è®¤é¢†ä»»åŠ¡ 1
         çŠ¶æ€æ›´æ–°ä¸º: in_progress
         åˆ†é…ç»™: Member A

         å¼€å§‹å®ç°..."

# å›¢é˜Ÿæˆå‘˜ B (ä¸Šåˆ 9:30)
$ export CLAUDE_CODE_TASK_LIST_ID=team-project-001
$ claude

> æŸ¥çœ‹ä»»åŠ¡
Claude: "å…±äº«ä»»åŠ¡åˆ—è¡¨: team-project-001

         è¿›è¡Œä¸­:
         [1] å®ç°ç”¨æˆ·API (Member A, å¼€å§‹äº 30åˆ†é’Ÿå‰)

         å¯ç”¨ä»»åŠ¡:
         [2] è®¾è®¡UIç»„ä»¶
         [3] ç¼–å†™æ–‡æ¡£

         è®¤é¢†ä»»åŠ¡ 2? [Y/n]"

> Y

Claude: "âœ“ ä»»åŠ¡ 2 å·²åˆ†é…
         Member A æ­£åœ¨å¤„ç†åç«¯
         ä½ è´Ÿè´£å‰ç«¯è®¾è®¡

         å¹¶è¡Œå·¥ä½œå¼€å§‹..."

# å›¢é˜Ÿæˆå‘˜ A (ä¸‹åˆ 2:00)
> ä»»åŠ¡çŠ¶æ€
Claude: "ä»»åŠ¡ 1 å®Œæˆ âœ“
         æ›´æ–°ä»»åŠ¡åˆ—è¡¨...

         å·²å®Œæˆ:
         [1] å®ç°ç”¨æˆ·API (Member A)

         è¿›è¡Œä¸­:
         [2] è®¾è®¡UIç»„ä»¶ (Member B, 75% å®Œæˆ)

         å¯ç”¨:
         [3] ç¼–å†™æ–‡æ¡£
         [4] é›†æˆå‰åç«¯ (æ–°ä»»åŠ¡ï¼Œä¾èµ– 1, 2)

         è®¤é¢†ä»»åŠ¡ 4? (ç­‰å¾…ä»»åŠ¡ 2 å®Œæˆ)"

---

# è·¨ä¼šè¯æŒä¹…åŒ–ç¤ºä¾‹

Session 1 (Day 1):
  â”œâ”€ åˆ›å»º 5 ä¸ªä»»åŠ¡
  â”œâ”€ å®Œæˆ Task 1, 2
  â””â”€ ä¿å­˜å¹¶é€€å‡º

Session 2 (Day 2, ä¸åŒè®¾å¤‡):
  â”œâ”€ æ¢å¤ä»»åŠ¡åˆ—è¡¨
  â”œâ”€ Task 3, 4 è‡ªåŠ¨ç»§ç»­
  â””â”€ Task 5 ä»åœ¨ç­‰å¾…

Session 3 (Day 3, å›¢é˜Ÿæˆå‘˜):
  â”œâ”€ è®¿é—®å…±äº«ä»»åŠ¡åˆ—è¡¨
  â”œâ”€ çœ‹åˆ°æ‰€æœ‰å†å²ä»»åŠ¡
  â””â”€ è®¤é¢†æ–°ä»»åŠ¡
```

---

## 5.3 Plan Mode å·¥ä½œæµç¨‹

### Plan Mode è¯¦è§£

```
Plan Mode çš„ä¸‰é˜¶æ®µå·¥ä½œæµ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: Explore (æ¢ç´¢é˜¶æ®µ)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ ç›®æ ‡: ç†è§£ç°çŠ¶å’Œå½±å“èŒƒå›´                                 â”‚
â”‚                                                          â”‚
â”‚ ä½¿ç”¨å·¥å…·:                                                â”‚
â”‚ âœ“ Read - è¯»å–ç›¸å…³æ–‡ä»¶                                    â”‚
â”‚ âœ“ Glob - æŸ¥æ‰¾æ–‡ä»¶æ¨¡å¼                                    â”‚
â”‚ âœ“ Grep - æœç´¢ä»£ç å†…å®¹                                    â”‚
â”‚ âœ“ WebSearch - æŸ¥æ‰¾æœ€ä½³å®è·µ                               â”‚
â”‚ âœ— Write/Edit - ä¸ä¿®æ”¹æ–‡ä»¶                                â”‚
â”‚ âœ— Bash - ä¸æ‰§è¡Œå‘½ä»¤                                      â”‚
â”‚                                                          â”‚
â”‚ è¾“å‡º:                                                    â”‚
â”‚ - é¡¹ç›®ç»“æ„ç†è§£                                           â”‚
â”‚ - ç°æœ‰å®ç°åˆ†æ                                           â”‚
â”‚ - ä¾èµ–å…³ç³»å›¾                                             â”‚
â”‚ - æ½œåœ¨å½±å“èŒƒå›´                                           â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: Plan (è§„åˆ’é˜¶æ®µ)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ ç›®æ ‡: åˆ¶å®šè¯¦ç»†å®æ–½è®¡åˆ’                                   â”‚
â”‚                                                          â”‚
â”‚ ç”Ÿæˆå†…å®¹:                                                â”‚
â”‚ 1. æ€»ä½“æ–¹æ¡ˆ                                              â”‚
â”‚    - æ¶æ„å†³ç­–                                            â”‚
â”‚    - æŠ€æœ¯é€‰å‹                                            â”‚
â”‚    - é£é™©è¯„ä¼°                                            â”‚
â”‚                                                          â”‚
â”‚ 2. è¯¦ç»†æ­¥éª¤                                              â”‚
â”‚    - æ–‡ä»¶çº§æ“ä½œåˆ—è¡¨                                      â”‚
â”‚    - æ¯ä¸ªä¿®æ”¹çš„è¯¦ç»†è¯´æ˜                                  â”‚
â”‚    - æµ‹è¯•ç­–ç•¥                                            â”‚
â”‚                                                          â”‚
â”‚ 3. æ›¿ä»£æ–¹æ¡ˆ                                              â”‚
â”‚    - Plan A (æ¨è)                                       â”‚
â”‚    - Plan B (å¤‡é€‰)                                       â”‚
â”‚    - æƒè¡¡åˆ†æ                                            â”‚
â”‚                                                          â”‚
â”‚ è¾“å‡ºæ ¼å¼:                                                â”‚
â”‚ Markdown è®¡åˆ’æ–‡æ¡£ä¿å­˜åˆ° .claude/plans/                   â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3: Execute (æ‰§è¡Œé˜¶æ®µ)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ ç”¨æˆ·å®¡æ‰¹å:                                              â”‚
â”‚ â”œâ”€ æ¥å—è®¡åˆ’ â†’ åˆ‡æ¢åˆ° Accepting Edits æ¨¡å¼                â”‚
â”‚ â”œâ”€ ä¿®æ”¹è®¡åˆ’ â†’ è¿”å› Phase 2                               â”‚
â”‚ â””â”€ æ‹’ç»è®¡åˆ’ â†’ é‡æ–°åˆ†ææˆ–å–æ¶ˆ                             â”‚
â”‚                                                          â”‚
â”‚ æ‰§è¡Œæ—¶:                                                  â”‚
â”‚ â”œâ”€ æŒ‰è®¡åˆ’é€æ­¥å®æ–½                                        â”‚
â”‚ â”œâ”€ è‡ªåŠ¨åˆ›å»ºä»»åŠ¡                                          â”‚
â”‚ â”œâ”€ å®æ—¶è¿›åº¦æŠ¥å‘Š                                          â”‚
â”‚ â””â”€ é‡åˆ°é—®é¢˜æ—¶æš‚åœè¯·æ±‚æŒ‡å¯¼                                â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Plan Mode å®æˆ˜ç¤ºä¾‹

```bash
# åœºæ™¯: é‡æ„è®¤è¯ç³»ç»Ÿ

User: /plan
User: "å°†è®¤è¯ç³»ç»Ÿä»Sessionæ”¹ä¸ºJWT"

Claude: [è¿›å…¥ Plan Modeï¼Œå¯åŠ¨ Explore Subagent]

  "å¼€å§‹åˆ†æé¡¹ç›®...

   Phase 1: æ¢ç´¢é˜¶æ®µ (é¢„è®¡ 5 åˆ†é’Ÿ)
   â³ æ­£åœ¨åˆ†æè®¤è¯ç›¸å…³æ–‡ä»¶..."

   [5 åˆ†é’Ÿå]

  "æ¢ç´¢å®Œæˆ âœ“

   å‘ç°:
   - 34 ä¸ªæ–‡ä»¶ä½¿ç”¨ Session è®¤è¯
   - ä¸»è¦æ¨¡å—:
     * src/auth/session.ts (æ ¸å¿ƒé€»è¾‘)
     * src/middleware/auth.ts (ä¸­é—´ä»¶)
     * 32 ä¸ª API è·¯ç”±ä½¿ç”¨è®¤è¯
   - ä¾èµ–:
     * express-session
     * connect-redis
   - æµ‹è¯•è¦†ç›–ç‡: 78%

   å½±å“èŒƒå›´: ä¸­ç­‰
   é¢„è®¡å·¥ä½œé‡: 4-6 å°æ—¶

   ç»§ç»­ç”Ÿæˆå®æ–½è®¡åˆ’? [Y/n]"

User: "Y"

Claude: "Phase 2: è§„åˆ’é˜¶æ®µ

   ç”Ÿæˆè¯¦ç»†è®¡åˆ’...

   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   é‡æ„è®¡åˆ’: Session â†’ JWT è®¤è¯
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   ## æ€»ä½“æ–¹æ¡ˆ

   **æ–¹æ³•**: æ¸è¿›å¼è¿ç§» (ä¿æŒå‘åå…¼å®¹)

   **æ¶æ„å†³ç­–**:
   - ä½¿ç”¨ jsonwebtoken åº“
   - HS256 ç®—æ³• (å¯¹ç§°åŠ å¯†)
   - Token æœ‰æ•ˆæœŸ: 24h
   - Refresh Token: 7å¤©

   **é£é™©**:
   ğŸŸ¡ ä¸­ç­‰ - éœ€è¦åŒæ—¶æ”¯æŒä¸¤ç§è®¤è¯æ–¹å¼
   ğŸŸ¢ ä½   - å·²æœ‰å®Œå–„çš„æµ‹è¯•è¦†ç›–

   ---

   ## å®æ–½æ­¥éª¤ (4ä¸ªé˜¶æ®µ)

   ### é˜¶æ®µ 1: å‡†å¤‡å·¥ä½œ (30åˆ†é’Ÿ)
   ```
   1.1 å®‰è£…ä¾èµ–
       npm install jsonwebtoken @types/jsonwebtoken

   1.2 é…ç½®ç¯å¢ƒå˜é‡
       åˆ›å»º .env.example:
       JWT_SECRET=your-secret-key
       JWT_EXPIRES_IN=24h
       REFRESH_TOKEN_EXPIRES_IN=7d

   1.3 åˆ›å»ºJWTå·¥å…·æ¨¡å—
       æ–‡ä»¶: src/auth/jwt.ts
       å†…å®¹:
       - generateToken(payload)
       - verifyToken(token)
       - refreshToken(token)
   ```

   ### é˜¶æ®µ 2: å®ç°JWTé€»è¾‘ (1.5å°æ—¶)
   ```
   2.1 å®ç° JWT ç”Ÿæˆ
       æ–‡ä»¶: src/auth/jwt.ts
       å‡½æ•°: generateToken, generateRefreshToken

   2.2 å®ç° JWT éªŒè¯ä¸­é—´ä»¶
       æ–‡ä»¶: src/middleware/jwtAuth.ts
       æ”¯æŒ Bearer Token å’Œ Cookie

   2.3 æ›´æ–°ç™»å½•ç«¯ç‚¹
       æ–‡ä»¶: src/auth/login.ts
       åŒæ—¶è¿”å› Session + JWT (å…¼å®¹æ¨¡å¼)
   ```

   ### é˜¶æ®µ 3: è¿ç§»API (2å°æ—¶)
   ```
   3.1 åˆ›å»ºå…¼å®¹ä¸­é—´ä»¶
       æ–‡ä»¶: src/middleware/hybridAuth.ts
       é€»è¾‘: å…ˆå°è¯• JWTï¼Œå¤±è´¥åˆ™ Session

   3.2 é€ä¸ªè¿ç§» API ç«¯ç‚¹ (32ä¸ª)
       æ‰¹æ¬¡ 1 (ä½é£é™©): ç”¨æˆ·ä¿¡æ¯API (8ä¸ª)
       æ‰¹æ¬¡ 2 (ä¸­é£é™©): æ•°æ®æŸ¥è¯¢API (15ä¸ª)
       æ‰¹æ¬¡ 3 (é«˜é£é™©): å†™å…¥æ“ä½œAPI (9ä¸ª)

   3.3 æ›´æ–°å‰ç«¯
       axios é…ç½®æ·»åŠ  Authorization header
   ```

   ### é˜¶æ®µ 4: æµ‹è¯•å’Œæ¸…ç† (1å°æ—¶)
   ```
   4.1 å•å…ƒæµ‹è¯•
       - JWT å·¥å…·å‡½æ•°æµ‹è¯•
       - ä¸­é—´ä»¶æµ‹è¯•

   4.2 é›†æˆæµ‹è¯•
       - å®Œæ•´ç™»å½•æµç¨‹
       - Token è¿‡æœŸå¤„ç†
       - Refresh Token æµç¨‹

   4.3 åˆ é™¤ Session ç›¸å…³ä»£ç 
       - ç§»é™¤ express-session
       - ç§»é™¤ connect-redis
       - æ¸…ç†é…ç½®

   4.4 æ›´æ–°æ–‡æ¡£
       - API æ–‡æ¡£
       - è®¤è¯æµç¨‹å›¾
   ```

   ---

   ## æ›¿ä»£æ–¹æ¡ˆ

   ### Plan A (æ¨è): æ¸è¿›å¼è¿ç§»
   âœ… ä¼˜ç‚¹:
      - é£é™©ä½ï¼Œå¯éšæ—¶å›æ»š
      - ä¸å½±å“ç°æœ‰ç”¨æˆ·
      - å……åˆ†æµ‹è¯•æ—¶é—´

   âš ï¸ ç¼ºç‚¹:
      - è¿‡æ¸¡æœŸç»´æŠ¤ä¸¤å¥—ç³»ç»Ÿ
      - ä»£ç å¤æ‚åº¦æš‚æ—¶å¢åŠ 

   ### Plan B: ä¸€æ¬¡æ€§æ›¿æ¢
   âœ… ä¼˜ç‚¹:
      - å¿«é€Ÿå®Œæˆ
      - ä»£ç æ›´ç®€æ´

   âŒ ç¼ºç‚¹:
      - é«˜é£é™©
      - ç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•
      - éš¾ä»¥å›æ»š

   ---

   ## æ—¶é—´ä¼°ç®—

   - é˜¶æ®µ 1: 30 åˆ†é’Ÿ
   - é˜¶æ®µ 2: 1.5 å°æ—¶
   - é˜¶æ®µ 3: 2 å°æ—¶
   - é˜¶æ®µ 4: 1 å°æ—¶
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   æ€»è®¡: 5 å°æ—¶

   ---

   ## æ–‡ä»¶æ¸…å•

   æ–°å¢æ–‡ä»¶ (3):
   - src/auth/jwt.ts
   - src/middleware/jwtAuth.ts
   - src/middleware/hybridAuth.ts

   ä¿®æ”¹æ–‡ä»¶ (35):
   - src/auth/login.ts
   - src/middleware/auth.ts
   - src/routes/*.ts (32ä¸ªAPIæ–‡ä»¶)

   åˆ é™¤æ–‡ä»¶ (2):
   - src/auth/session.ts
   - src/config/redis.ts

   ---

   è®¡åˆ’å·²ä¿å­˜åˆ°:
   .claude/plans/session-to-jwt-20260208.md

   æ˜¯å¦æ‰§è¡Œæ­¤è®¡åˆ’? [Y/n/ä¿®æ”¹]"

User: "Y"

Claude: "åˆ‡æ¢åˆ°æ‰§è¡Œæ¨¡å¼...

         åˆ›å»º 4 ä¸ªä»»åŠ¡:
         [1] å‡†å¤‡å·¥ä½œ
         [2] å®ç°JWTé€»è¾‘ (ä¾èµ–: 1)
         [3] è¿ç§»API (ä¾èµ–: 2)
         [4] æµ‹è¯•å’Œæ¸…ç† (ä¾èµ–: 3)

         å¼€å§‹æ‰§è¡Œä»»åŠ¡ 1..."

         [30 åˆ†é’Ÿå]
         "âœ“ ä»»åŠ¡ 1 å®Œæˆ
          â³ ä»»åŠ¡ 2 è¿›è¡Œä¸­ (45% å®Œæˆ)

          å½“å‰æ­¥éª¤: å®ç° JWT éªŒè¯ä¸­é—´ä»¶

          é¢„è®¡å‰©ä½™æ—¶é—´: 3.5 å°æ—¶"
```

---

## 5.4 Skills ç³»ç»Ÿ

### Skills è¯¦è§£

```
Skills = æŒä¹…åŒ–çš„æŒ‡ä»¤ + å·¥å…·

ä½œç”¨:
1. å°è£…å¸¸è§æ“ä½œ
2. ä¿æŒä¸€è‡´æ€§
3. å›¢é˜ŸçŸ¥è¯†å…±äº«
4. å‡å°‘é‡å¤è¯´æ˜
```

### Skill ç»“æ„

```yaml
# .claude/skills/code-review/SKILL.md

---
name: "code-review"
description: "æ‰§è¡Œå…¨é¢çš„ä»£ç å®¡æŸ¥"
when:
  - "ç”¨æˆ·è¯·æ±‚ä»£ç å®¡æŸ¥"
  - "Pull Request éœ€è¦å®¡æŸ¥"
  - "æ˜¾å¼è°ƒç”¨ /code-review"
tools:
  - Read
  - Grep
  - Bash
  - WebSearch
visibility: "project"  # project, user, global
version: "1.2.0"
author: "Your Team"
---

# Code Review Skill

å½“æ‰§è¡Œä»£ç å®¡æŸ¥æ—¶ï¼Œéµå¾ªä»¥ä¸‹æ¸…å•:

## 1. é™æ€åˆ†æ (5 åˆ†é’Ÿ)

```bash
# è¿è¡Œ Linter
npm run lint

# ç±»å‹æ£€æŸ¥
npm run typecheck

# ä»£ç å¤æ‚åº¦
npx complexity-report src/
```

æ£€æŸ¥:
- âœ“ æ—  Lint é”™è¯¯
- âœ“ ç±»å‹å®‰å…¨
- âœ“ åœˆå¤æ‚åº¦ < 10

## 2. å®‰å…¨å®¡æŸ¥ (10 åˆ†é’Ÿ)

```bash
# ä¾èµ–æ¼æ´æ‰«æ
npm audit

# å¯†é’¥æ³„éœ²æ£€æµ‹
git-secrets --scan

# OWASP æ£€æŸ¥
npm run security:check
```

é‡ç‚¹å…³æ³¨:
- [ ] SQL æ³¨å…¥
- [ ] XSS æ¼æ´
- [ ] CSRF ä¿æŠ¤
- [ ] æ•æ„Ÿä¿¡æ¯æ³„éœ²

## 3. æ€§èƒ½åˆ†æ (5 åˆ†é’Ÿ)

æœç´¢æ¨¡å¼:
- ğŸ” `O(nÂ²)` ç®—æ³•
- ğŸ” å¤§å‹å¾ªç¯åµŒå¥—
- ğŸ” ä¸å¿…è¦çš„é‡æ¸²æŸ“
- ğŸ” å†…å­˜æ³„æ¼

## 4. æµ‹è¯•è¦†ç›– (10 åˆ†é’Ÿ)

```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# æ£€æŸ¥æ–°ä»£ç è¦†ç›–ç‡
diff-coverage baseline.json current.json
```

è¦æ±‚:
- æ–°ä»£ç è¦†ç›–ç‡ >= 80%
- å…³é”®è·¯å¾„ 100% è¦†ç›–

## 5. æœ€ä½³å®è·µ (15 åˆ†é’Ÿ)

ä»£ç è§„èŒƒ:
- [ ] DRY åŸåˆ™
- [ ] SOLID åŸåˆ™
- [ ] é€‚å½“çš„é”™è¯¯å¤„ç†
- [ ] æœ‰æ„ä¹‰çš„å‘½å
- [ ] å……åˆ†çš„æ³¨é‡Š

## 6. ç”ŸæˆæŠ¥å‘Š

æ ¼å¼:

```markdown
# Code Review Report

## æ¦‚è¿°
- å®¡æŸ¥èŒƒå›´: [æ–‡ä»¶æ•°é‡]
- å‘ç°é—®é¢˜: [æ€»æ•°]
  - ğŸ”´ ä¸¥é‡: [æ•°é‡]
  - ğŸŸ¡ è­¦å‘Š: [æ•°é‡]
  - ğŸ”µ å»ºè®®: [æ•°é‡]

## é—®é¢˜è¯¦æƒ…

### ğŸ”´ ä¸¥é‡é—®é¢˜
1. [é—®é¢˜æè¿°]
   æ–‡ä»¶: [è·¯å¾„:è¡Œå·]
   å»ºè®®: [ä¿®å¤æ–¹æ¡ˆ]

### ğŸŸ¡ è­¦å‘Š
...

### ğŸ”µ å»ºè®®
...

## æ€»ä½“è¯„ä»·
[é€šè¿‡/éœ€è¦ä¿®æ”¹/æ‹’ç»]
```

## è°ƒç”¨ç¤ºä¾‹

```bash
# å®Œæ•´å®¡æŸ¥
/code-review

# ä»…å®¡æŸ¥ç‰¹å®šæ–‡ä»¶
/code-review src/auth/*.ts

# å¿«é€Ÿå®¡æŸ¥ (è·³è¿‡æŸäº›æ£€æŸ¥)
/code-review --quick
```
```

### Skill ç±»å‹å’Œç¤ºä¾‹

```
ä¸‰å±‚ Skills æ¶æ„:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Personal Skills (~/.claude/skills/)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨æˆ·ä¸ªäººçš„å¸¸ç”¨æŠ€èƒ½                       â”‚
â”‚                                         â”‚
â”‚ ç¤ºä¾‹:                                   â”‚
â”‚ - /my-review (ä¸ªäººå®¡æŸ¥åå¥½)             â”‚
â”‚ - /my-commit (ä¸ªäººæäº¤é£æ ¼)             â”‚
â”‚ - /optimize (ä¸ªäººä¼˜åŒ–ç­–ç•¥)              â”‚
â”‚                                         â”‚
â”‚ é€‚ç”¨: æ‰€æœ‰é¡¹ç›®                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Project Skills (.claude/skills/)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¡¹ç›®ç‰¹å®šçš„å›¢é˜Ÿå…±äº«æŠ€èƒ½                   â”‚
â”‚                                         â”‚
â”‚ ç¤ºä¾‹:                                   â”‚
â”‚ - /review (å›¢é˜Ÿä»£ç å®¡æŸ¥æ ‡å‡†)            â”‚
â”‚ - /deploy (é¡¹ç›®éƒ¨ç½²æµç¨‹)                â”‚
â”‚ - /test (é¡¹ç›®æµ‹è¯•ç­–ç•¥)                  â”‚
â”‚                                         â”‚
â”‚ é€‚ç”¨: å½“å‰é¡¹ç›®                          â”‚
â”‚ å¯é€šè¿‡ Git å…±äº«ç»™å›¢é˜Ÿ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Plugin Skills (bundled)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ’ä»¶æä¾›çš„æŠ€èƒ½                           â”‚
â”‚                                         â”‚
â”‚ ç¤ºä¾‹:                                   â”‚
â”‚ - /db-query (æ•°æ®åº“æ’ä»¶)                â”‚
â”‚ - /api-test (APIæµ‹è¯•æ’ä»¶)               â”‚
â”‚ - /design-import (Figmaæ’ä»¶)            â”‚
â”‚                                         â”‚
â”‚ é€‚ç”¨: å®‰è£…äº†ç›¸åº”æ’ä»¶çš„ç¯å¢ƒ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é«˜çº§ Skill ç¤ºä¾‹

```yaml
# .claude/skills/deploy/SKILL.md

---
name: "deploy"
description: "å®‰å…¨çš„éƒ¨ç½²æµç¨‹"
when:
  - "/deploy"
  - "ç”¨æˆ·è¯·æ±‚éƒ¨ç½²"
tools:
  - Bash
  - Read
  - Task
params:
  - name: "environment"
    type: "string"
    enum: ["staging", "production"]
    required: true
  - name: "skip_tests"
    type: "boolean"
    default: false
---

# Deploy Skill

## éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

```javascript
// è‡ªåŠ¨æ‰§è¡Œçš„æ£€æŸ¥
const checks = [
  {
    name: "GitçŠ¶æ€æ£€æŸ¥",
    command: "git status --porcelain",
    expect: "",  // åº”è¯¥æ— æœªæäº¤æ›´æ”¹
    critical: true
  },
  {
    name: "åœ¨æ­£ç¡®çš„åˆ†æ”¯",
    command: "git branch --show-current",
    expect: (env) => env === "production" ? "main" : "develop",
    critical: true
  },
  {
    name: "æ‰€æœ‰æµ‹è¯•é€šè¿‡",
    command: "npm test",
    skip_if: "${skip_tests}",
    critical: true
  },
  {
    name: "æ„å»ºæˆåŠŸ",
    command: "npm run build",
    critical: true
  },
  {
    name: "ä¾èµ–å®‰å…¨å®¡è®¡",
    command: "npm audit --audit-level=high",
    critical: false  // è­¦å‘Šä½†ä¸é˜»æ­¢
  }
];
```

## éƒ¨ç½²æµç¨‹

### Staging éƒ¨ç½²
```bash
#!/bin/bash
set -e

echo "éƒ¨ç½²åˆ° Staging..."

# 1. æ„å»º
npm run build:staging

# 2. ä¸Šä¼ 
aws s3 sync dist/ s3://staging-bucket/

# 3. æ¸…é™¤ CDN ç¼“å­˜
aws cloudfront create-invalidation \
  --distribution-id ${STAGING_DIST_ID} \
  --paths "/*"

# 4. å¥åº·æ£€æŸ¥
curl -f https://staging.example.com/health || exit 1

echo "âœ“ Staging éƒ¨ç½²æˆåŠŸ"
echo "URL: https://staging.example.com"
```

### Production éƒ¨ç½²
```bash
#!/bin/bash
set -e

echo "âš ï¸  å‡†å¤‡éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ..."

# é¢å¤–çš„ç”Ÿäº§æ£€æŸ¥
echo "è¿è¡Œå†’çƒŸæµ‹è¯•..."
npm run test:smoke

echo "æ£€æŸ¥æ•°æ®åº“è¿ç§»..."
npm run db:check-migrations

# éœ€è¦äºŒæ¬¡ç¡®è®¤
read -p "ç¡®è®¤éƒ¨ç½²åˆ°ç”Ÿäº§? (yes/no): " confirm
if [ "$confirm" != "yes" ]; then
  echo "éƒ¨ç½²å·²å–æ¶ˆ"
  exit 1
fi

# åˆ›å»ºéƒ¨ç½²æ ‡ç­¾
TAG="deploy-$(date +%Y%m%d-%H%M%S)"
git tag -a $TAG -m "Production deploy"
git push origin $TAG

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build:production

# è“ç»¿éƒ¨ç½²
./scripts/blue-green-deploy.sh

# è‡ªåŠ¨å›æ»šæœºåˆ¶
if ! ./scripts/health-check.sh; then
  echo "âŒ å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œè‡ªåŠ¨å›æ»š..."
  ./scripts/rollback.sh $TAG
  exit 1
fi

echo "âœ“ ç”Ÿäº§éƒ¨ç½²æˆåŠŸ"
echo "URL: https://example.com"
echo "æ ‡ç­¾: $TAG"

# é€šçŸ¥å›¢é˜Ÿ
./scripts/notify-slack.sh "éƒ¨ç½²æˆåŠŸ: $TAG"
```

## å›æ»šæµç¨‹

```bash
/deploy rollback <tag-name>
```

## è°ƒç”¨ç¤ºä¾‹

```bash
# éƒ¨ç½²åˆ° staging
/deploy staging

# éƒ¨ç½²åˆ°ç”Ÿäº§
/deploy production

# è·³è¿‡æµ‹è¯• (ç´§æ€¥ä¿®å¤)
/deploy staging --skip-tests

# å›æ»š
/deploy rollback deploy-20260208-143022
```

## æƒé™è¦æ±‚

ç”Ÿäº§éƒ¨ç½²éœ€è¦:
- [ ] ä¸¤ä¸ªå›¢é˜Ÿæˆå‘˜æ‰¹å‡†
- [ ] æ‰€æœ‰ CI æ£€æŸ¥é€šè¿‡
- [ ] åœ¨ç»´æŠ¤çª—å£å†…
- [ ] æœ‰å›æ»šè®¡åˆ’
```

### Skill ç»„åˆ

```bash
# åœºæ™¯: å®Œæ•´çš„å‘å¸ƒæµç¨‹

# Skill 1: ä»£ç å®¡æŸ¥
/code-review

  â†“ (å®¡æŸ¥é€šè¿‡)

# Skill 2: è¿è¡Œæµ‹è¯•
/test --full

  â†“ (æµ‹è¯•é€šè¿‡)

# Skill 3: ç”Ÿæˆå‘å¸ƒè¯´æ˜
/release-notes v2.1.0

  â†“ (ç”Ÿæˆ CHANGELOG.md)

# Skill 4: éƒ¨ç½²
/deploy production

  â†“ (éƒ¨ç½²æˆåŠŸ)

# Skill 5: å‘å¸ƒå…¬å‘Š
/announce "Version 2.1.0 released"

---

# æˆ–è€…åˆ›å»ºç»„åˆ Skill:

# .claude/skills/release/SKILL.md

---
name: "release"
description: "å®Œæ•´çš„å‘å¸ƒæµç¨‹"
---

# Release Skill

å®Œæ•´å‘å¸ƒæµç¨‹:

```bash
# 1. ä»£ç å®¡æŸ¥
invoke-skill code-review

# 2. æµ‹è¯•
invoke-skill test --full

# 3. ç”Ÿæˆå‘å¸ƒè¯´æ˜
invoke-skill release-notes ${version}

# 4. éƒ¨ç½²
invoke-skill deploy production

# 5. å…¬å‘Š
invoke-skill announce "Version ${version} released"

# 6. æ¸…ç†
invoke-skill cleanup
```

è°ƒç”¨:
```bash
/release v2.1.0
```

ä¸€æ¡å‘½ä»¤å®Œæˆæ•´ä¸ªå‘å¸ƒæµç¨‹ ğŸš€
```

---

## ä¸‹ä¸€æ­¥

- å­¦ä¹  [Hook ç³»ç»Ÿ](./06-hook-system.md)ï¼Œå®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–
- æŸ¥çœ‹ [MCP é›†æˆ](./07-mcp-integration.md)ï¼Œæ‰©å±•å·¥å…·èƒ½åŠ›
- å‚è€ƒ [æœ€ä½³å®è·µ](./08-best-practices.md)ï¼Œä¼˜åŒ–å¼€å‘æµç¨‹

---

**å‚è€ƒèµ„æº**:
- [Claude Code Tasks](https://code.claude.com/docs/en/tasks)
- [Agent Skills æ–‡æ¡£](https://code.claude.com/docs/zh-CN/skills)
- [Plan Mode å®è·µ](https://medium.com/@automateandtweak/how-to-use-plan-mode-in-claude-code-vs-code-the-smart-way-to-code-with-ai-a93d1b437646)
